============================================================
Testing omni_attention_simple...
============================================================
[attn_naive] batch[0] head[0] row[64]: row_max=2.79266930, row_sum=15.01964569
[attn_naive] batch[0] head[0] row[0]: row_max=2.19294405, row_sum=22.13076973
[attn_naive] batch[0] head[0] row[192]: row_max=3.52248001, row_sum=18.53489685
[attn_naive] batch[0] head[0] row[128]: row_max=3.35124135, row_sum=15.08171654
[attn_naive] batch[0] head[0] row[320]: row_max=2.39811945, row_sum=51.53223038
[attn_naive] batch[0] head[0] row[256]: row_max=2.47394967, row_sum=48.81948471
[attn_naive] batch[0] head[0] row[384]: row_max=3.97975159, row_sum=19.06385231
[attn_naive] batch[0] head[0] row[448]: row_max=2.91315651, row_sum=51.19674301
[attn_naive] batch[0] head[0] row[512]: row_max=3.05367208, row_sum=48.01009750
[attn_naive] batch[0] head[0] row[576]: row_max=3.06179237, row_sum=64.04360199
[attn_naive] batch[0] head[0] row[640]: row_max=3.23694921, row_sum=48.18571091
[attn_naive] batch[0] head[0] row[704]: row_max=3.04146075, row_sum=61.71494293
[attn_naive] batch[0] head[0] row[832]: row_max=3.56774592, row_sum=40.27471161
[attn_naive] batch[0] head[0] row[768]: row_max=3.00664020, row_sum=70.04584503
[attn_naive] batch[0] head[0] row[896]: row_max=4.54703236, row_sum=22.79882812
[attn_naive] batch[0] head[0] row[960]: row_max=2.93569040, row_sum=94.24790192
[attn_naive] batch[0] head[0] row[64]: row_max=2.79266930, row_sum=15.01964569
[attn_naive] batch[0] head[0] row[0]: row_max=2.19294405, row_sum=22.13076973
[attn_naive] batch[0] head[0] row[192]: row_max=3.52248001, row_sum=18.53489685
[attn_naive] batch[0] head[0] row[128]: row_max=3.35124135, row_sum=15.08171654
[attn_naive] batch[0] head[0] row[320]: row_max=2.39811945, row_sum=51.53223038
[attn_naive] batch[0] head[0] row[256]: row_max=2.47394967, row_sum=48.81948471
[attn_naive] batch[0] head[0] row[384]: row_max=3.97975159, row_sum=19.06385231
[attn_naive] batch[0] head[0] row[448]: row_max=2.91315651, row_sum=51.19674301
[attn_naive] batch[0] head[0] row[512]: row_max=3.05367208, row_sum=48.01009750
[attn_naive] batch[0] head[0] row[576]: row_max=3.06179237, row_sum=64.04360199
[attn_naive] batch[0] head[0] row[704]: row_max=3.04146075, row_sum=61.71494293
[attn_naive] batch[0] head[0] row[640]: row_max=3.23694921, row_sum=48.18571091
[attn_naive] batch[0] head[0] row[768]: row_max=3.00664020, row_sum=70.04584503
[attn_naive] batch[0] head[0] row[832]: row_max=3.56774592, row_sum=40.27471161
[attn_naive] batch[0] head[0] row[960]: row_max=2.93569040, row_sum=94.24790192
[attn_naive] batch[0] head[0] row[896]: row_max=4.54703236, row_sum=22.79882812


============================================================
Testing omni_attn_shared_kv...
============================================================
[omni_attn_shared_kv] batch[0] head[0] row[64]: row_max=2.79101562, row_sum=15.03990173
[omni_attn_shared_kv] batch[0] head[0] row[0]: row_max=2.19140625, row_sum=22.16259384
[omni_attn_shared_kv] batch[0] head[0] row[192]: row_max=3.52148438, row_sum=18.55258179
[omni_attn_shared_kv] batch[0] head[0] row[128]: row_max=3.35156250, row_sum=15.07785130
[omni_attn_shared_kv] batch[0] head[0] row[320]: row_max=2.39843750, row_sum=51.51458359
[omni_attn_shared_kv] batch[0] head[0] row[256]: row_max=2.47460938, row_sum=48.78707123
[omni_attn_shared_kv] batch[0] head[0] row[448]: row_max=2.91406250, row_sum=51.15291595
[omni_attn_shared_kv] batch[0] head[0] row[384]: row_max=3.97851562, row_sum=19.08646202
[omni_attn_shared_kv] batch[0] head[0] row[576]: row_max=3.06054688, row_sum=64.11961365
[omni_attn_shared_kv] batch[0] head[0] row[512]: row_max=3.05468750, row_sum=47.96260071
[omni_attn_shared_kv] batch[0] head[0] row[704]: row_max=3.04101562, row_sum=61.74320221
[omni_attn_shared_kv] batch[0] head[0] row[640]: row_max=3.23437500, row_sum=48.30856705
[omni_attn_shared_kv] batch[0] head[0] row[832]: row_max=3.56835938, row_sum=40.24871826
[omni_attn_shared_kv] batch[0] head[0] row[768]: row_max=3.00781250, row_sum=69.96424866
[omni_attn_shared_kv] batch[0] head[0] row[960]: row_max=2.93750000, row_sum=94.07775879
[omni_attn_shared_kv] batch[0] head[0] row[896]: row_max=4.54687500, row_sum=22.80027962
[omni_attn_shared_kv] batch[0] head[0] row[0]: row_max=2.19140625, row_sum=22.16259384
[omni_attn_shared_kv] batch[0] head[0] row[64]: row_max=2.79101562, row_sum=15.03990173
[omni_attn_shared_kv] batch[0] head[0] row[128]: row_max=3.35156250, row_sum=15.07785130
[omni_attn_shared_kv] batch[0] head[0] row[192]: row_max=3.52148438, row_sum=18.55258179
[omni_attn_shared_kv] batch[0] head[0] row[320]: row_max=2.39843750, row_sum=51.51458359
[omni_attn_shared_kv] batch[0] head[0] row[256]: row_max=2.47460938, row_sum=48.78707123
[omni_attn_shared_kv] batch[0] head[0] row[384]: row_max=3.97851562, row_sum=19.08646202
[omni_attn_shared_kv] batch[0] head[0] row[448]: row_max=2.91406250, row_sum=51.15291595
[omni_attn_shared_kv] batch[0] head[0] row[576]: row_max=3.06054688, row_sum=64.11961365
[omni_attn_shared_kv] batch[0] head[0] row[512]: row_max=3.05468750, row_sum=47.96260071
[omni_attn_shared_kv] batch[0] head[0] row[704]: row_max=3.04101562, row_sum=61.74320221
[omni_attn_shared_kv] batch[0] head[0] row[640]: row_max=3.23437500, row_sum=48.30856705
[omni_attn_shared_kv] batch[0] head[0] row[768]: row_max=3.00781250, row_sum=69.96424866
[omni_attn_shared_kv] batch[0] head[0] row[832]: row_max=3.56835938, row_sum=40.24871826
[omni_attn_shared_kv] batch[0] head[0] row[960]: row_max=2.93750000, row_sum=94.07775879
[omni_attn_shared_kv] batch[0] head[0] row[896]: row_max=4.54687500, row_sum=22.80027962
[omni_attn_shared_kv] PASSED (max_diff=0.001953, mean_diff=0.000066), min_diff=0.000000

============================================================
Testing omni_attention_simple with data/1024/debug_data_F_C.pt(25% causal blocks, 75% full blocks)...
============================================================
| Row Index | row_max / row_sum        |
|-----------|-------------------------|
| 0         | 2.19294405 / 22.13076973|
| 64        | 2.79266930 / 15.01964569|
| 128       | 3.35124135 / 15.08171654|
| 192       | 3.52248001 / 18.53489685|
| 256       | 2.47394967 / 48.81948471|
| 320       | 2.39811945 / 51.53223038|
| 384       | 3.97975159 / 19.06385231|
| 448       | 2.91315651 / 51.19674301|
| 512       | 3.05367208 / 48.01009750|
| 576       | 3.06179237 / 64.04360199|
| 640       | 3.23694921 / 48.18571091|
| 704       | 3.04146075 / 61.71494293|
| 768       | 3.00664020 / 70.04584503|
| 832       | 3.56774592 / 40.27471161|
| 896       | 4.54703236 / 22.79882812|
| 960       | 2.93569040 / 94.24790192|

============================================================
Testing omni_attn_shared_kv...
============================================================
| Row Index | row_max / row_sum       |
|-----------|-------------------------|
| 0         | 2.19140625 / 22.16259384|
| 64        | 2.79101562 / 15.03990173|
| 128       | 3.35156250 / 15.07785130|
| 192       | 3.52148438 / 18.55258179|
| 256       | 2.47460938 / 48.78707123|
| 320       | 2.39843750 / 51.51458359|
| 384       | 3.97851562 / 19.08646202|
| 448       | 2.91406250 / 51.15291595|
| 512       | 3.05468750 / 47.96260071|
| 576       | 3.06054688 / 64.11961365|
| 640       | 3.23437500 / 48.30856705|
| 704       | 3.04101562 / 61.74320221|
| 768       | 3.00781250 / 69.96424866|
| 832       | 3.56835938 / 40.24871826|
| 896       | 4.54687500 / 22.80027962|
| 960       | 2.93750000 / 94.07775879|